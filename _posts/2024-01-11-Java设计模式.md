---
title: Java设计模式
author: mumu
date: 2024-01-11 14:00:00 +0800
categories: [Java,Java设计模式]
tags: [Java,Java设计模式]
pin: false
---

# Java设计模式

## 1 单例模式（Singleton）

### 1.1. 饿汉式

> 类加载到内存后，就实例化一个单例，JVM保证线程安全
> 简单实用，<font color='cornflowerblue' style='background-color:yellow' size=''>推荐使用！</font>
>
> <font color='red' style='background-color:' size=''>唯一缺点：不管用到与否，类装载时就完成实例化</font>
> Class.forName("")
> （话说你不用的，你装载它干啥）

```java
private static final Mgr01 INSTANCE = new Mgr01();
private Mgr01() {};
public static Mgr01 getInstance() {
    return INSTANCE;
}
```

### 1.2. 懒汉式

> 虽然达到了按需初始化的目的，但却带来<font color='red' style='background-color:' size=''>线程不安全</font>的问题

```java
private static Mgr03 INSTANCE;
private Mgr03() {}
public static Mgr03 getInstance() {
    if (INSTANCE == null) 
        INSTANCE = new Mgr03();
    return INSTANCE;
}
```

> <font color='cornflowerblue' style='background-color:' size=''>synchronized</font>修饰方法，但是<font color='red' style='background-color:' size=''>效率会下降</font>

```java
private static Mgr04 INSTANCE;
private Mgr04() {}
public static synchronized Mgr04 getInstance() {
    if (INSTANCE == null) 
        INSTANCE = new Mgr04();
    return INSTANCE;
}
```

> <font color='blue' style='background-color:' size=''>双重检查</font>

```java
private static volatile Mgr06 INSTANCE; 
private Mgr06() {}
public static Mgr06 getInstance() {
    if (INSTANCE == null) {
        synchronized (Mgr06.class) {
            if(INSTANCE == null) 
                INSTANCE = new Mgr06();
        }
    }
    return INSTANCE;
}
```

### 1.3. 其他形式

> 静态内部类

```java
private Mgr07() {}
private static class Mgr07Holder {
    private final static Mgr07 INSTANCE = new Mgr07();
}
public static Mgr07 getInstance() {
    return Mgr07Holder.INSTANCE;
}
```

> 直接使用枚举
>
> 不仅可以解决线程同步，还可以防止反序列化。

```java
public enum Mgr08 {
    INSTANCE;
}
```

## 2 策略模式（Strategy）

> 适用于通用的比较方法

```java
package java.lang;
public interface Comparable<T> {
	public int compareTo(T o);
}
```

> 比较器：和通用 compareTo 不同的比较策略

```java
package java.util;
@FunctionalInterface
public interface Comparator<T> {
	int compare(T o1, T o2);
    //others...
}
```

```java
public class Achievement implements Comparable<Achievement> {
    private int chinese;
    private int math;
    private int english;
    private int totalScore;
     @Override
    public int compareTo(Achievement achievement) {
        return this.totalScore - achievement.totalScore;
    }
}
```

> 数学成绩比较器

```java
public class MathComparator implements Comparator<Achievement> {
    @Override
    public int compare(Achievement a1, Achievement a2) {
        return a1.getMath() - a2.getMath();
    }
}
```

## 3 工厂模式（Factory）

> 简单工厂模式：简单工厂类生成不同的对象 
>
> `SimpleXXXactory.createXXX()`

```java
public class SimpleTestPaperFactory {
    public static ChineseTestPaper createChinesePaper() {        return new ChineseTestPaper();    }
    public static MathTestPaper createMathPaper() {        return new MathTestPaper();    }
    public static EnglishTestPaper createEnglishPaper() {        return new EnglishTestPaper();    }
}
```

> 工厂模式：具体类的具有独有的生成工厂
>
> <font color='red' style='background-color:' size=''>优点：方便产品单一的扩展，只需要增加对应的产品工厂</font>
>
> `XXXFactory.create()`

```java
public class MathTestPaper implements Testable {}
```

```java
public interface Testable {}
```

```java
public class MathTestPaperFactory {
    public static Testable create() {        return new MathTestPaper();    }
}
```

> 抽象工厂：可生成一系列“产品”，每系列”产品“可横向分为产品族
>
> <font color='red' style='background-color:' size=''>优点：可方便扩展产品族</font>
>
> <font color='cornflowerblue' style='background-color:' size=''>缺点：单一产品的扩展，要改动香港系列的所有产品产品</font>
>
> ![img](https://raw.githubusercontent.com/sn-mumu/cloud-storage/main/PicGo/2024/01/202401151108587)

```java
public abstract class AbstractTestPaperFactory {
    abstract ChineseTestPaper createChineseTestPaper();
    abstract MathTestPaper createMathTestPaper();
}
```

```java
public abstract class ChineseTestPaper  {
    abstract void articleTitle();
}
```

```java
public abstract class MathTestPaper {
    abstract void additionalQuestions();
}
```

```java
public class Grade1TestPaperFactory extends AbstractTestPaperFactory {
    @Override
    public ChineseTestPaper createChineseTestPaper() {
        return new Grade1ChineseTestPaper();
    }

    @Override
    public MathTestPaper createMathTestPaper() {
        return new Grade1MathTestPaper();
    }
}
```

```java
public class Grade2TestPaperFactory extends AbstractTestPaperFactory {
    @Override
    public ChineseTestPaper createChineseTestPaper() {
        return new Grade2ChineseTestPaper();
    }
    @Override
    public MathTestPaper createMathTestPaper() {
        return new Grade2MathTestPaper();
    }
}
```

```java
public class Grade1ChineseTestPaper extends ChineseTestPaper {
    @Override
    void articleTitle() {
        System.out.println("Grade1ChineseTestPaperFactory ArticleTitle is eee");
    }
}
```

```java
public class Grade1MathTestPaper extends MathTestPaper{
    @Override
    void additionalQuestions() {
        System.out.println("Grade1MathTestPaper additionalQuestions is 1+1=?");
    }
}
```

```java
public class Grade2ChineseTestPaper extends ChineseTestPaper {
    @Override
    void articleTitle() {
        System.out.println("Grade2ChineseTestPaperFactory ArticleTitle is sanzijing");
    }
}
```

```java
public class Grade2MathTestPaper extends MathTestPaper{
    @Override
    void additionalQuestions() {
        System.out.println("Grade2MathTestPaper additionalQuestions is 2*X+5=0 X=?");
    }
}
```

## 4 门面(Facade)调停者（Mediator）

> ![image-20240115143311800](https://raw.githubusercontent.com/sn-mumu/cloud-storage/main/PicGo/2024/01/202401151433889.png)

> 调停者
>
> ![image-20240115143939835](https://raw.githubusercontent.com/sn-mumu/cloud-storage/main/PicGo/2024/01/202401151439885.png)





## 5 装饰器(Decorator)

![image-20240115153638840](https://raw.githubusercontent.com/sn-mumu/cloud-storage/main/PicGo/2024/01/202401151536975.png)

## 6 责任链(ChainOfResponsibility)

